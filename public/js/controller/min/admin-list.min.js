$(window).on("load",function(){var t;callListApi(),$(document).on("click","#delete-admin",function(t){t.preventDefault();var e=$(this).closest("[admin-id]").attr("admin-id"),a=$(this);swal({title:"Excluir",text:"Você tem certeza que deseja excluir o administrador?",icon:"warning",buttons:{cancel:{text:"Cancelar",value:!1,visible:!0,className:"",closeModal:!0},confirm:{text:"OK",value:!0,visible:!0,className:"",closeModal:!0}},dangerMode:!0}).then(t=>{t&&($.blockUI({message:$("#preloader").html()}),$.ajax({url:"/admin/remove",type:"POST",dataType:"JSON",data:{id:e}}).done(function(t){!0!==t.error?(alertify.success(t.message),a.closest("tr").remove()):alertify.error(t.message)}).fail(function(){alertify.error("Ocorreu um error")}).always(function(){$.unblockUI()}))})}),$("#search").on("keydown",function(e){clearTimeout(t);var a=$("#search").val();t=setTimeout(function(){callListApi(1,a)},500)}),$("[search-btn]").click(function(t){t.preventDefault(),callListApi(1,$("#search").val())}),$(document).on("click","#edit-admin",function(t){t.preventDefault();let e=$(this).closest("td").attr("admin-id");window.location.href="editar-admin/"+e}),$(document).on("click","#edit-profile",function(t){t.preventDefault(),window.location.href="meu-perfil"})});var totalPages,adminId=$("[admin-access]").attr("admin-access"),currentPage=1;function callListApi(t=1,e=null){$.blockUI({message:$("#preloader").html()});var a="/admin?page="+t;null!=e&&""!=e&&(a="admin/search?page="+t+"&query="+e),$.ajax({url:a,type:"POST",dataType:"JSON"}).done(function(t){if(!0===t.error)return alertify.error("Ocorreu um erro"),void setTimeout(function(){window.location.href="/admin"},2e3);populateTable(t.data.data),totalPages=t.data.last_page,currentPage=t.data.current_page,$("#pagination").twbsPagination("destroy");var a={visiblePages:5,next:"Próximo",prev:"Anterior",first:"Primeiro",last:"Último",initiateStartPageClick:!1,onPageClick:function(t,a){callListApi(a,e)}};$("#pagination").twbsPagination($.extend({},a,{totalPages:totalPages,startPage:t.data.current_page}))}).fail(function(){alertify.error("Ocorreu um erro"),setTimeout(function(){window.location.href="/admin"},2e3)}).always(function(){$.unblockUI()})}function populateTable(t){var e="";if(0==t.length)return e+='<p class="text-center text-info h2">Sem Administradores</p>',void $("#list-content").html(e);e+='<table class="table table-hover bg-dark text-white "><thead><tr><th width="5%" scope="col">Status</th><th width="30%" scope="col">Nome</th><th width="33%" scope="col">Email</th> <th width="20%" scope="col">Nível</th><th scope="col" width="12%">Ações</th></tr> </thead><tbody>',$.each(t,function(t,a){let i=new Admin(a);e+='<tr><th scope="row" class="align-middle"><i class="fas fa-circle text-center d-block '+i.getActive()+'"></i></th> <td>'+i.name+"</td><td>"+i.login+"</td><td>"+i.getAccessLevel()+"</td>",adminId==i.id?e+=' <td class="align-middle"><span class="d-flex justify-content-between "><i id="edit-profile" class="far fa-edit icon"></span></td>':e+=' <td class="align-middle" admin-id="'+i.id+'"><span class="d-flex justify-content-between "><i id="edit-admin" class="far fa-edit icon"></i><i id="delete-admin" class="far fa-trash-alt icon"></i></span></td>',e+=" </tr>"}),e+="</tbody></table>",$("#list-content").html(e)}